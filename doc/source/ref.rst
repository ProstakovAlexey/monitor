Описание программы
==================

Назначение
----------
Программа мониторинга Monitor предназначена для мониторинга ТИ совместно с системой Zabbix. Может сообщать следующие параметры ТИ:
    - кол-во СМЭВ запросов, направленных ТИ;
    - кол-во предоставленных ТИ ответов на СМЭВ запросы, пришедших из сторонних ИС;
    - кол-во заявлений ПГУ/МФЦ полученных ТИ;
    - кол-во ответов на заявления ПГУ/МФЦ.

.. _Состав:

Состав
------
Программа написана на языке Python3 и использует стороннюю библиотеки pypyodbc для работы с БД. 
Программа состоит из 2-х основных частей:

    1. Cерверная часть. Устанавливается на сервер с ТИ, работает с IIS.
        - config.ini - файл с конфигурацией, для подсоединения к БД;
        - errorCode.txt - коды ошибок и их описание (вы можете дополнить/изменить описания);
        - cgi.py - веб-приложение;
        - getInfo.py - хранит функции для извлечения информации из БД;
        - sendRequest.py - функция запроса к веб-сервису;
        - tests.py - тесты для проверки работоспособности сервиса;
    2. Клиентская часть. Устанавливается на компьютера в Zabbix.
        - sendRequest.py - функция запроса к веб-сервису;
        - monitorRequest.py - программа клиент, отправляет запросы на сервер.
    3. Документация. Находится в папке doc/

Принцип работы
--------------
    1. Серверная часть устанавливается на IIS и ожидает запроса по адресу http://IP/monitor/cgi.py.
    2. Клиентская часть устанавливается на сервер с Zabbix. 
    3. Настраивается Zabbix агент, который обращается к клиентской программе, передавая в качестве параметра нужный вид сведений.
    4. Клиентская программа отправляет запрос на сервер и получает ответ сразу по всем видам сведений. Далее оне извлекает только нужные сведения и возвращает их как ответ Zabbix агенту. Ответ это целое число >=0, если в ответ пришла -1 это ошибка. При правильно установленной и проверенной серверной части может возникнуть только из неработоспособности IIS или SQL, важный сигнал!
    5. Zabbix использует ответ для построения своих графиков и прочего.

